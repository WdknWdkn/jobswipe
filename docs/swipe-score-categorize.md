# スワイプ→スコアリング→カテゴライズの仕様

このドキュメントでは、JobSwipe アプリにおける質問スワイプからスコア算出、結果カテゴライズまでの流れを解説します。

## フロー概要
1. **スワイプ (回答入力)**
   - `/diagnosis` ページで `SwipeCard` コンポーネントが表示されます。
   - 左右へのスワイプ操作で **YES/NO** を選択します。
   - `Diagnosis.tsx` 内の `handleSwipe` 関数で回答が `answers` 配列に追加されます。
   - 全ての質問に回答すると `/results` へ遷移し、回答情報を状態として渡します。
2. **スコアリング**
   - `utils/scoring.ts` の `calculateCategoryScores` 関数で回答を処理します。
   - 各質問は `questions.ts` で `category` と `weight` を持ちます。
   - カテゴリごとに以下を計算します。
     - そのカテゴリの質問の **合計 weight**
     - YES と回答した質問の **weight 合計**
   - (YES の weight 合計 / 総 weight) × 100 をパーセンテージとして算出します。
3. **カテゴライズ**
   - `utils/diagnostics.ts` の `calculateScores` でスコアをもとに以下を決定します。
    - 各カテゴリのスコアをパーセンテージ順に並び替え、上位 5 つを `topCategories` とする。
     - 最上位カテゴリから `personalityType` を決定する (`personalityMap`)。
     - `topCategories` を用いて `recommendations` を生成する。
   - `Results.tsx` で `ResultChart` とともにこれらの情報を表示します。

## 主な関連ファイル
- `src/pages/Diagnosis.tsx` – スワイプ操作のロジック。
- `src/utils/scoring.ts` – カテゴリスコア計算ロジック。
- `src/utils/diagnostics.ts` – スコアからタイプや推薦を決定。
- `src/data/questions.ts` – 質問データとカテゴリ定義。
- `src/data/recommendations.ts` – 各カテゴリへのおすすめ情報。

## トレードオフを考慮した設計

従来は各カテゴリのスコアが独立していましたが、実際の就活では複数の条件が互いに
トレードオフの関係にあります。新しい仕様では次の点を踏まえて設計を行います。

### 主なトレードオフ軸

1. **高収入 ⟷ ワークライフバランス** – 例: 投資銀行の高給と長時間労働
2. **チャレンジ ⟷ 安定性** – スタートアップの成長機会と雇用リスク
3. **成長機会 ⟷ ワークライフバランス** – コンサルの急成長とプライベート犠牲
4. **社会貢献 ⟷ 経済的報酬** – NPO活動の意義と低収入
5. **専門性 ⟷ 汎用的成長** – 医師の専門性と転職可能性

### 質問設計の改善

トレードオフを明確にするため、質問文をより具体化します。

例: `"初任給は同世代平均より高い方が良い"` → `"高い給与のためなら週末も働くことは厭わない"`

### スコアリング条件の変更

スコアリング時に特定カテゴリを重視すると相反するカテゴリのスコアを自動的に調整
します。例えば給与を重視する回答が多いほど、ワークライフバランスのスコアは下が
るように計算します。これにより現実的なバランスを反映したパーセンテージが得られ
ます。

### 推薦ロジックの変更

業界推薦では、メリットとデメリットを合わせて提示します。例として以下のような情
報を返します。

```typescript
{
  industry: '投資銀行・金融',
  pros: ['業界トップクラスの高収入'],
  cons: ['長時間労働が常態化'],
  requiredTradeoffs: ['ワークライフバランスを犠牲にした高収入']
}
```

### 期待される効果

* 理想と現実のギャップを理解しやすくなる
* トレードオフを踏まえた意思決定が可能になる
* デメリットを事前に把握することで後悔を減らせる
* 現実に即した選択を促し、キャリア満足度向上につながる

